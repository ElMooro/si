<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crisis Monitoring Platform - Real-Time Financial Stress Dashboard</title>
    
    <!-- Required Libraries -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #151932 100%);
            color: #e0e0e0;
            min-height: 100vh;
        }
        
        /* Header Styles */
        .header {
            background: rgba(20, 24, 44, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-bottom: 1px solid rgba(255, 68, 68, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ff4444, #ffaa00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Crisis Level Banner */
        .crisis-banner {
            width: 100%;
            padding: 1rem;
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
            position: sticky;
            top: 80px;
            z-index: 999;
            transition: all 0.3s;
        }
        
        .crisis-banner.LOW {
            background: linear-gradient(90deg, #00ff44, #00ff88);
            color: #000;
        }
        
        .crisis-banner.MODERATE {
            background: linear-gradient(90deg, #ffaa00, #ffd700);
            color: #000;
        }
        
        .crisis-banner.ELEVATED {
            background: linear-gradient(90deg, #ff8800, #ffaa00);
            color: #000;
            animation: pulseWarning 2s infinite;
        }
        
        .crisis-banner.HIGH {
            background: linear-gradient(90deg, #ff4444, #ff6666);
            color: #fff;
            animation: pulseAlert 1.5s infinite;
        }
        
        .crisis-banner.CRITICAL {
            background: linear-gradient(90deg, #ff0000, #ff4444);
            color: #fff;
            animation: criticalAlert 1s infinite;
        }
        
        @keyframes pulseWarning {
            0%, 100% { opacity: 0.9; }
            50% { opacity: 1; }
        }
        
        @keyframes pulseAlert {
            0%, 100% { opacity: 0.85; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.01); }
        }
        
        @keyframes criticalAlert {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.02); }
        }
        
        /* Tabs Navigation */
        .tabs-nav {
            display: flex;
            gap: 0.5rem;
            margin: 2rem auto;
            max-width: 1600px;
            padding: 0 2rem;
            overflow-x: auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 0.5rem;
        }
        
        .tab-btn {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            border-radius: 8px;
            color: #888;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, #ff4444, #ffaa00);
            color: #fff;
            font-weight: bold;
        }
        
        /* Tab Content */
        .tab-content {
            display: none;
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 2rem 2rem;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Container */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Crisis Probability Display */
        .crisis-probability-section {
            background: linear-gradient(135deg, rgba(255, 68, 68, 0.1), rgba(255, 170, 0, 0.1));
            border: 2px solid rgba(255, 68, 68, 0.3);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .probability-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3rem;
            margin-bottom: 1.5rem;
        }
        
        .probability-circle {
            position: relative;
            width: 180px;
            height: 180px;
        }
        
        .probability-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            font-weight: bold;
        }
        
        .probability-label {
            font-size: 0.875rem;
            color: #888;
            text-transform: uppercase;
            margin-top: 0.5rem;
        }
        
        /* Stress Indicators Grid */
        .stress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stress-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .stress-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 68, 68, 0.2);
        }
        
        .stress-card.alert {
            animation: stressAlert 2s infinite;
            border-color: #ff4444;
        }
        
        @keyframes stressAlert {
            0%, 100% { 
                box-shadow: 0 0 0 rgba(255, 68, 68, 0);
            }
            50% { 
                box-shadow: 0 0 20px rgba(255, 68, 68, 0.6);
            }
        }
        
        .stress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .stress-title {
            font-size: 0.875rem;
            color: #888;
            text-transform: uppercase;
        }
        
        .stress-score {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .score-low {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
        }
        
        .score-medium {
            background: rgba(255, 170, 0, 0.2);
            color: #ffaa00;
        }
        
        .score-high {
            background: rgba(255, 68, 68, 0.2);
            color: #ff4444;
        }
        
        .stress-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .stress-change {
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .positive { color: #00ff88; }
        .negative { color: #ff4444; }
        .neutral { color: #888; }
        
        /* Components Grid */
        .components-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
        }
        
        .component-item {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .component-name {
            font-size: 0.875rem;
            color: #888;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }
        
        .component-score {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .component-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-top: 0.5rem;
            overflow: hidden;
        }
        
        .component-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 1s ease;
        }
        
        .fill-low {
            background: linear-gradient(90deg, #00ff88, #00ccff);
        }
        
        .fill-medium {
            background: linear-gradient(90deg, #ffaa00, #ffd700);
        }
        
        .fill-high {
            background: linear-gradient(90deg, #ff4444, #ff8888);
        }
        
        /* Charts Section */
        .charts-section {
            margin-bottom: 2rem;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .chart-title {
            font-size: 1.25rem;
            font-weight: bold;
        }
        
        .chart {
            height: 400px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
        }
        
        /* Status Indicators */
        .status-bar {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 2rem;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            font-size: 0.875rem;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .status-dot.connected {
            background: #00ff88;
        }
        
        .status-dot.error {
            background: #ff4444;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Section Headers */
        .section-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 1.25rem;
            font-weight: bold;
        }
        
        /* Refresh Timer */
        .refresh-timer {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: rgba(20, 24, 44, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 1rem;
            font-size: 0.875rem;
            z-index: 100;
        }
        
        .timer-value {
            font-weight: bold;
            color: #00ff88;
        }
        
        /* Loading Spinner */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 68, 68, 0.3);
            border-top-color: #ff4444;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Error Message */
        .error-message {
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid #ff4444;
            color: #ff6666;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            text-align: center;
        }
        
        /* Data Card for individual endpoints */
        .endpoint-data {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .data-row:last-child {
            border-bottom: none;
        }
        
        .data-label {
            color: #888;
            font-size: 0.875rem;
            text-transform: uppercase;
        }
        
        .data-value {
            font-weight: bold;
            font-size: 1.125rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .stress-grid {
                grid-template-columns: 1fr;
            }
            
            .components-grid {
                grid-template-columns: 1fr;
            }
            
            .probability-display {
                flex-direction: column;
                gap: 1rem;
            }
            
            .tabs-nav {
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">
            ‚ö†Ô∏è Crisis Monitoring Platform
            <span style="font-size: 0.875rem; color: #888;">Real-Time</span>
        </div>
        
        <div class="status-bar">
            <div class="status-item">
                <div class="status-dot" id="apiStatus"></div>
                <span>Crisis API</span>
            </div>
            <div class="status-item">
                <span>Last Update:</span>
                <span id="lastUpdate">--:--:--</span>
            </div>
        </div>
    </header>
    
    <!-- Crisis Level Banner -->
    <div class="crisis-banner" id="crisisBanner">
        üîÑ INITIALIZING CRISIS MONITORING SYSTEM...
    </div>
    
    <!-- Navigation Tabs -->
    <div class="tabs-nav">
        <button class="tab-btn active" data-tab="overview">
            <span>üìä</span>
            <span>Overview</span>
        </button>
        <button class="tab-btn" data-tab="dashboard">
            <span>üéØ</span>
            <span>Dashboard</span>
        </button>
        <button class="tab-btn" data-tab="treasury">
            <span>üèõÔ∏è</span>
            <span>Treasury</span>
        </button>
        <button class="tab-btn" data-tab="market">
            <span>üìà</span>
            <span>Market</span>
        </button>
        <button class="tab-btn" data-tab="liquidity">
            <span>üíß</span>
            <span>Liquidity</span>
        </button>
        <button class="tab-btn" data-tab="systemic">
            <span>üè¶</span>
            <span>Systemic</span>
        </button>
        <button class="tab-btn" data-tab="probability">
            <span>üé≤</span>
            <span>Probability</span>
        </button>
    </div>
    
    <!-- Overview Tab (All Indicators) -->
    <div class="tab-content active" id="overview">
        <!-- Crisis Probability Section -->
        <div class="crisis-probability-section">
            <div class="probability-display">
                <div class="probability-circle">
                    <svg width="180" height="180">
                        <circle cx="90" cy="90" r="80" fill="none" stroke="rgba(255, 255, 255, 0.1)" stroke-width="10"/>
                        <circle id="probabilityArcOverview" cx="90" cy="90" r="80" fill="none" stroke="url(#gradient)" stroke-width="10" 
                                stroke-dasharray="502" stroke-dashoffset="502" transform="rotate(-90 90 90)"/>
                        <defs>
                            <linearGradient id="gradient">
                                <stop offset="0%" stop-color="#00ff88"/>
                                <stop offset="50%" stop-color="#ffaa00"/>
                                <stop offset="100%" stop-color="#ff4444"/>
                            </linearGradient>
                        </defs>
                    </svg>
                    <div class="probability-value" id="probabilityValueOverview">--%</div>
                </div>
                <div>
                    <h2>Crisis Probability</h2>
                    <div class="probability-label" id="crisisLevelOverview">CALCULATING...</div>
                    <div class="components-grid" id="componentsGridOverview">
                        <!-- Components will be added here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- All Stress Indicators -->
        <div class="section-header">
            <span>üìä</span>
            <span>Treasury Market Stress</span>
        </div>
        <div class="stress-grid" id="treasuryGridOverview">
            <div class="loading"><div class="spinner"></div></div>
        </div>
        
        <div class="section-header">
            <span>üìà</span>
            <span>Market Stress Indicators</span>
        </div>
        <div class="stress-grid" id="marketGridOverview">
            <div class="loading"><div class="spinner"></div></div>
        </div>
        
        <div class="section-header">
            <span>üíß</span>
            <span>Liquidity & Funding Stress</span>
        </div>
        <div class="stress-grid" id="liquidityGridOverview">
            <div class="loading"><div class="spinner"></div></div>
        </div>
        
        <div class="section-header">
            <span>üè¶</span>
            <span>Systemic Risk Indicators</span>
        </div>
        <div class="stress-grid" id="systemicGridOverview">
            <div class="loading"><div class="spinner"></div></div>
        </div>
    </div>
    
    <!-- Dashboard Tab -->
    <div class="tab-content" id="dashboard">
        <div class="endpoint-data">
            <h2 style="margin-bottom: 1.5rem;">Complete Crisis Dashboard</h2>
            <div id="dashboardContent">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>
        
        <div class="charts-section">
            <div class="chart-container">
                <div class="chart-header">
                    <h2 class="chart-title">Crisis Components Timeline</h2>
                </div>
                <div id="dashboardChart" class="chart"></div>
            </div>
        </div>
    </div>
    
    <!-- Treasury Tab -->
    <div class="tab-content" id="treasury">
        <div class="endpoint-data">
            <h2 style="margin-bottom: 1.5rem;">Treasury Market Stress Analysis</h2>
            <div id="treasuryContent">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Treasury Stress Indicators</h2>
            </div>
            <div id="treasuryChart" class="chart"></div>
        </div>
    </div>
    
    <!-- Market Tab -->
    <div class="tab-content" id="market">
        <div class="endpoint-data">
            <h2 style="margin-bottom: 1.5rem;">Market Stress Analysis</h2>
            <div id="marketContent">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Market Stress Indicators</h2>
            </div>
            <div id="marketChart" class="chart"></div>
        </div>
    </div>
    
    <!-- Liquidity Tab -->
    <div class="tab-content" id="liquidity">
        <div class="endpoint-data">
            <h2 style="margin-bottom: 1.5rem;">Liquidity & Funding Analysis</h2>
            <div id="liquidityContent">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Liquidity Indicators</h2>
            </div>
            <div id="liquidityChart" class="chart"></div>
        </div>
    </div>
    
    <!-- Systemic Tab -->
    <div class="tab-content" id="systemic">
        <div class="endpoint-data">
            <h2 style="margin-bottom: 1.5rem;">Systemic Risk Analysis</h2>
            <div id="systemicContent">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Systemic Risk Indicators</h2>
            </div>
            <div id="systemicChart" class="chart"></div>
        </div>
    </div>
    
    <!-- Probability Tab -->
    <div class="tab-content" id="probability">
        <div class="crisis-probability-section">
            <div class="probability-display">
                <div class="probability-circle">
                    <svg width="180" height="180">
                        <circle cx="90" cy="90" r="80" fill="none" stroke="rgba(255, 255, 255, 0.1)" stroke-width="10"/>
                        <circle id="probabilityArcDetail" cx="90" cy="90" r="80" fill="none" stroke="url(#gradient2)" stroke-width="10" 
                                stroke-dasharray="502" stroke-dashoffset="502" transform="rotate(-90 90 90)"/>
                        <defs>
                            <linearGradient id="gradient2">
                                <stop offset="0%" stop-color="#00ff88"/>
                                <stop offset="50%" stop-color="#ffaa00"/>
                                <stop offset="100%" stop-color="#ff4444"/>
                            </linearGradient>
                        </defs>
                    </svg>
                    <div class="probability-value" id="probabilityValueDetail">--%</div>
                </div>
                <div>
                    <h2>Crisis Probability Analysis</h2>
                    <div class="probability-label" id="crisisLevelDetail">CALCULATING...</div>
                </div>
            </div>
        </div>
        
        <div class="endpoint-data">
            <h2 style="margin-bottom: 1.5rem;">Probability Details</h2>
            <div id="probabilityContent">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Probability Trend</h2>
            </div>
            <div id="probabilityChart" class="chart"></div>
        </div>
    </div>
    
    <!-- Refresh Timer -->
    <div class="refresh-timer">
        Next refresh in: <span class="timer-value" id="refreshTimer">60</span>s
    </div>
    
    <script>
        // Crisis API Configuration
        const CRISIS_API = {
            baseUrl: 'https://632cocxo10.execute-api.us-east-1.amazonaws.com/prod',
            endpoints: {
                health: '/health',
                dashboard: '/crisis/dashboard',
                probability: '/crisis/probability',
                treasury: '/crisis/treasury',
                market: '/crisis/market',
                liquidity: '/crisis/liquidity',
                systemic: '/crisis/systemic'
            }
        };
        
        // Global state
        let currentData = {
            dashboard: null,
            probability: null,
            treasury: null,
            market: null,
            liquidity: null,
            systemic: null,
            historicalData: []
        };
        
        let activeTab = 'overview';
        let refreshInterval = null;
        let countdownInterval = null;
        let refreshCountdown = 60;
        
        // Initialize the platform
        async function initializePlatform() {
            console.log('üöÄ Initializing Crisis Monitoring Platform...');
            
            // Set up event listeners
            setupEventListeners();
            
            // Test API connection
            await testAPIConnection();
            
            // Load all data
            await loadAllData();
            
            // Initialize charts
            initializeCharts();
            
            // Start auto-refresh (60 seconds)
            startAutoRefresh();
            
            console.log('‚úÖ Platform initialized successfully');
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Tab navigation
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    // Remove active class from all tabs
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    btn.classList.add('active');
                    const tabId = btn.dataset.tab;
                    document.getElementById(tabId).classList.add('active');
                    
                    activeTab = tabId;
                    
                    // Load data for the active tab if needed
                    loadTabData(tabId);
                });
            });
        }
        
        // Test API connection
        async function testAPIConnection() {
            const statusDot = document.getElementById('apiStatus');
            statusDot.className = 'status-dot';
            
            try {
                const response = await fetch(CRISIS_API.baseUrl + CRISIS_API.endpoints.health);
                if (response.ok) {
                    statusDot.classList.add('connected');
                    console.log('‚úÖ Crisis API connected');
                } else {
                    statusDot.classList.add('error');
                    console.error('‚ùå Crisis API error');
                }
            } catch (error) {
                statusDot.classList.add('error');
                console.error('‚ùå Crisis API connection failed:', error);
            }
        }
        
        // Load all data from Crisis API
        async function loadAllData() {
            try {
                // Load all endpoints in parallel
                const [dashboardRes, probabilityRes, treasuryRes, marketRes, liquidityRes, systemicRes] = await Promise.all([
                    fetch(CRISIS_API.baseUrl + CRISIS_API.endpoints.dashboard),
                    fetch(CRISIS_API.baseUrl + CRISIS_API.endpoints.probability),
                    fetch(CRISIS_API.baseUrl + CRISIS_API.endpoints.treasury),
                    fetch(CRISIS_API.baseUrl + CRISIS_API.endpoints.market),
                    fetch(CRISIS_API.baseUrl + CRISIS_API.endpoints.liquidity),
                    fetch(CRISIS_API.baseUrl + CRISIS_API.endpoints.systemic)
                ]);
                
                // Parse responses
                if (dashboardRes.ok) currentData.dashboard = await dashboardRes.json();
                if (probabilityRes.ok) currentData.probability = await probabilityRes.json();
                if (treasuryRes.ok) currentData.treasury = await treasuryRes.json();
                if (marketRes.ok) currentData.market = await marketRes.json();
                if (liquidityRes.ok) currentData.liquidity = await liquidityRes.json();
                if (systemicRes.ok) currentData.systemic = await systemicRes.json();
                
                // Update displays
                updateAllDisplays();
                
                // Update last update time
                const now = new Date();
                document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
                
                // Store historical data point
                if (currentData.probability) {
                    currentData.historicalData.push({
                        timestamp: now,
                        probability: currentData.probability.probability,
                        components: currentData.probability.components
                    });
                    
                    // Keep only last 100 data points
                    if (currentData.historicalData.length > 100) {
                        currentData.historicalData.shift();
                    }
                }
                
            } catch (error) {
                console.error('Error loading data:', error);
                showError('Failed to load crisis data. Retrying...');
            }
        }
        
        // Load data for specific tab
        async function loadTabData(tabId) {
            switch(tabId) {
                case 'overview':
                    updateOverviewTab();
                    break;
                case 'dashboard':
                    updateDashboardTab();
                    break;
                case 'treasury':
                    updateTreasuryTab();
                    break;
                case 'market':
                    updateMarketTab();
                    break;
                case 'liquidity':
                    updateLiquidityTab();
                    break;
                case 'systemic':
                    updateSystemicTab();
                    break;
                case 'probability':
                    updateProbabilityTab();
                    break;
            }
        }
        
        // Update all displays
        function updateAllDisplays() {
            // Update crisis banner and probability display
            if (currentData.probability) {
                updateCrisisBanner(currentData.probability);
            }
            
            // Update active tab
            loadTabData(activeTab);
        }
        
        // Update crisis banner
        function updateCrisisBanner(data) {
            const crisisBanner = document.getElementById('crisisBanner');
            const level = data.level;
            
            let bannerText = '';
            switch(level) {
                case 'LOW':
                    bannerText = '‚úÖ LOW RISK - Markets Operating Normally';
                    break;
                case 'MODERATE':
                    bannerText = '‚ö†Ô∏è MODERATE RISK - Increased Monitoring Required';
                    break;
                case 'ELEVATED':
                    bannerText = 'üî∂ ELEVATED RISK - Stress Building in Markets';
                    break;
                case 'HIGH':
                    bannerText = 'üî¥ HIGH RISK - Significant Market Stress Detected';
                    break;
                case 'CRITICAL':
                    bannerText = 'üö® CRITICAL RISK - Crisis Conditions Present';
                    break;
            }
            crisisBanner.textContent = bannerText;
            crisisBanner.className = `crisis-banner ${level}`;
        }
        
        // Update Overview Tab
        function updateOverviewTab() {
            if (!currentData.dashboard) return;
            
            // Update probability display
            updateProbabilityDisplay('probabilityValueOverview', 'crisisLevelOverview', 'probabilityArcOverview', 
                                     'componentsGridOverview', currentData.dashboard.crisis_assessment);
            
            // Update all grids
            updateTreasuryIndicators('treasuryGridOverview', currentData.dashboard.treasury_indicators);
            updateMarketIndicators('marketGridOverview', currentData.dashboard.market_indicators);
            updateLiquidityIndicators('liquidityGridOverview', currentData.dashboard.liquidity_indicators);
            updateSystemicIndicators('systemicGridOverview', currentData.dashboard.systemic_indicators);
        }
        
        // Update Dashboard Tab
        function updateDashboardTab() {
            if (!currentData.dashboard) return;
            
            const content = document.getElementById('dashboardContent');
            content.innerHTML = '';
            
            // Display complete dashboard data
            const sections = [
                { title: 'Crisis Assessment', data: currentData.dashboard.crisis_assessment },
                { title: 'Treasury Indicators', data: currentData.dashboard.treasury_indicators },
                { title: 'Market Indicators', data: currentData.dashboard.market_indicators },
                { title: 'Liquidity Indicators', data: currentData.dashboard.liquidity_indicators },
                { title: 'Systemic Indicators', data: currentData.dashboard.systemic_indicators }
            ];
            
            sections.forEach(section => {
                const sectionDiv = document.createElement('div');
                sectionDiv.style.marginBottom = '2rem';
                sectionDiv.innerHTML = `<h3 style="margin-bottom: 1rem; color: #ffaa00;">${section.title}</h3>`;
                
                for (const [key, value] of Object.entries(section.data)) {
                    const row = document.createElement('div');
                    row.className = 'data-row';
                    
                    let displayValue = value;
                    if (typeof value === 'number') {
                        displayValue = value.toFixed(2);
                    } else if (typeof value === 'object') {
                        displayValue = JSON.stringify(value);
                    }
                    
                    row.innerHTML = `
                        <span class="data-label">${key.replace(/_/g, ' ')}</span>
                        <span class="data-value">${displayValue}</span>
                    `;
                    sectionDiv.appendChild(row);
                }
                
                content.appendChild(sectionDiv);
            });
            
            // Update chart
            updateDashboardChart();
        }
        
        // Update Treasury Tab
        function updateTreasuryTab() {
            if (!currentData.treasury) return;
            
            const content = document.getElementById('treasuryContent');
            content.innerHTML = '';
            
            const data = currentData.treasury.treasury_stress;
            
            for (const [key, value] of Object.entries(data)) {
                const row = document.createElement('div');
                row.className = 'data-row';
                
                let displayValue = value;
                if (typeof value === 'number') {
                    displayValue = value.toFixed(2);
                }
                
                row.innerHTML = `
                    <span class="data-label">${key.replace(/_/g, ' ')}</span>
                    <span class="data-value" style="color: ${getColorForValue(key, value)}">${displayValue}</span>
                `;
                content.appendChild(row);
            }
            
            // Update chart
            updateTreasuryChart();
        }
        
        // Update Market Tab
        function updateMarketTab() {
            if (!currentData.market) return;
            
            const content = document.getElementById('marketContent');
            content.innerHTML = '';
            
            const data = currentData.market.market_stress;
            
            for (const [key, value] of Object.entries(data)) {
                const row = document.createElement('div');
                row.className = 'data-row';
                
                let displayValue = value;
                if (typeof value === 'number' && value !== null) {
                    displayValue = value.toFixed(2);
                } else if (value === null) {
                    displayValue = 'N/A';
                }
                
                row.innerHTML = `
                    <span class="data-label">${key.replace(/_/g, ' ')}</span>
                    <span class="data-value" style="color: ${getColorForValue(key, value)}">${displayValue}</span>
                `;
                content.appendChild(row);
            }
            
            // Update chart
            updateMarketChart();
        }
        
        // Update Liquidity Tab
        function updateLiquidityTab() {
            if (!currentData.liquidity) return;
            
            const content = document.getElementById('liquidityContent');
            content.innerHTML = '';
            
            const data = currentData.liquidity.liquidity_stress;
            
            for (const [key, value] of Object.entries(data)) {
                const row = document.createElement('div');
                row.className = 'data-row';
                
                let displayValue = value;
                if (key === 'RESERVES' && value) {
                    displayValue = `${(value / 1000).toFixed(1)}T`;
                } else if (typeof value === 'number' && value !== null) {
                    displayValue = value.toFixed(2);
                } else if (value === null) {
                    displayValue = 'N/A';
                }
                
                row.innerHTML = `
                    <span class="data-label">${key.replace(/_/g, ' ')}</span>
                    <span class="data-value" style="color: ${getColorForValue(key, value)}">${displayValue}</span>
                `;
                content.appendChild(row);
            }
            
            // Update chart
            updateLiquidityChart();
        }
        
        // Update Systemic Tab
        function updateSystemicTab() {
            if (!currentData.systemic) return;
            
            const content = document.getElementById('systemicContent');
            content.innerHTML = '';
            
            const data = currentData.systemic.systemic_risk;
            
            for (const [key, value] of Object.entries(data)) {
                const row = document.createElement('div');
                row.className = 'data-row';
                
                let displayValue = value;
                if (typeof value === 'number' && value !== null) {
                    displayValue = value.toFixed(2);
                } else if (value === null) {
                    displayValue = 'N/A';
                }
                
                row.innerHTML = `
                    <span class="data-label">${key.replace(/_/g, ' ')}</span>
                    <span class="data-value" style="color: ${getColorForValue(key, value)}">${displayValue}</span>
                `;
                content.appendChild(row);
            }
            
            // Update chart
            updateSystemicChart();
        }
        
        // Update Probability Tab
        function updateProbabilityTab() {
            if (!currentData.probability) return;
            
            // Update probability display
            updateProbabilityDisplay('probabilityValueDetail', 'crisisLevelDetail', 'probabilityArcDetail', 
                                     null, currentData.probability);
            
            const content = document.getElementById('probabilityContent');
            content.innerHTML = '';
            
            // Display probability details
            for (const [key, value] of Object.entries(currentData.probability)) {
                const row = document.createElement('div');
                row.className = 'data-row';
                
                let displayValue = value;
                if (typeof value === 'number') {
                    displayValue = value.toFixed(2);
                } else if (typeof value === 'object') {
                    displayValue = JSON.stringify(value);
                }
                
                row.innerHTML = `
                    <span class="data-label">${key.replace(/_/g, ' ')}</span>
                    <span class="data-value">${displayValue}</span>
                `;
                content.appendChild(row);
            }
            
            // Update chart
            updateProbabilityChart();
        }
        
        // Update probability display
        function updateProbabilityDisplay(valueId, levelId, arcId, gridId, assessment) {
            const probabilityValue = document.getElementById(valueId);
            const crisisLevel = document.getElementById(levelId);
            const probabilityArc = document.getElementById(arcId);
            
            const probability = assessment.probability;
            const level = assessment.level;
            
            // Update probability value
            probabilityValue.textContent = `${probability}%`;
            probabilityValue.style.color = getColorForProbability(probability);
            
            // Update level text
            crisisLevel.textContent = `CRISIS LEVEL: ${level}`;
            
            // Update probability arc
            const circumference = 2 * Math.PI * 80;
            const offset = circumference - (probability / 100 * circumference);
            probabilityArc.style.strokeDashoffset = offset;
            
            // Update components if grid exists
            if (gridId && assessment.components) {
                updateComponents(gridId, assessment.components);
            }
        }
        
        // Update components display
        function updateComponents(gridId, components) {
            const grid = document.getElementById(gridId);
            grid.innerHTML = '';
            
            const componentNames = {
                treasury: 'Treasury',
                market: 'Market',
                liquidity: 'Liquidity',
                systemic: 'Systemic'
            };
            
            for (const [key, score] of Object.entries(components)) {
                const item = document.createElement('div');
                item.className = 'component-item';
                
                const fillClass = score <= 3 ? 'fill-low' : score <= 6 ? 'fill-medium' : 'fill-high';
                const scoreColor = score <= 3 ? '#00ff88' : score <= 6 ? '#ffaa00' : '#ff4444';
                
                item.innerHTML = `
                    <div class="component-name">${componentNames[key] || key}</div>
                    <div class="component-score" style="color: ${scoreColor}">${score}/10</div>
                    <div class="component-bar">
                        <div class="component-fill ${fillClass}" style="width: ${score * 10}%"></div>
                    </div>
                `;
                
                grid.appendChild(item);
            }
        }
        
        // Update treasury indicators
        function updateTreasuryIndicators(gridId, treasury) {
            const grid = document.getElementById(gridId);
            grid.innerHTML = '';
            
            const indicators = [
                {
                    title: 'Bid-to-Cover Ratio',
                    value: treasury.bid_to_cover,
                    score: treasury.stress_score,
                    interpretation: treasury.bid_to_cover < 2 ? 'Weak demand' : treasury.bid_to_cover < 2.3 ? 'Moderate demand' : 'Strong demand'
                },
                {
                    title: 'Foreign Participation',
                    value: treasury.foreign_participation,
                    score: treasury.stress_score,
                    suffix: '%',
                    interpretation: 'Foreign buyer interest'
                },
                {
                    title: 'Indirect Bidders',
                    value: treasury.indirect_bidder_pct,
                    score: treasury.stress_score,
                    suffix: '%',
                    interpretation: 'Institutional demand'
                }
            ];
            
            indicators.forEach(indicator => {
                if (indicator.value !== null && indicator.value !== undefined) {
                    grid.appendChild(createStressCard(indicator));
                }
            });
        }
        
        // Update market indicators
        function updateMarketIndicators(gridId, market) {
            const grid = document.getElementById(gridId);
            grid.innerHTML = '';
            
            const indicators = [
                {
                    title: 'VIX (Volatility)',
                    value: market.VIX,
                    score: market.stress_score,
                    interpretation: market.VIX < 15 ? 'Low volatility' : market.VIX < 20 ? 'Normal' : market.VIX < 30 ? 'Elevated fear' : 'High fear'
                },
                {
                    title: 'TED Spread',
                    value: market.TED_SPREAD,
                    score: market.stress_score,
                    suffix: '%',
                    interpretation: market.TED_SPREAD < 0.3 ? 'Normal' : market.TED_SPREAD < 0.5 ? 'Mild stress' : 'Credit stress'
                },
                {
                    title: '10Y-2Y Spread',
                    value: market.TERM_SPREAD_10Y2Y,
                    score: market.stress_score,
                    suffix: '%',
                    interpretation: market.TERM_SPREAD_10Y2Y < 0 ? 'Inverted (recession signal)' : 'Normal curve'
                },
                {
                    title: 'Dollar Index (DXY)',
                    value: market.DXY,
                    score: market.stress_score,
                    interpretation: market.DXY > 105 ? 'Strong dollar' : market.DXY > 100 ? 'Above average' : 'Below average'
                }
            ];
            
            indicators.forEach(indicator => {
                if (indicator.value !== null && indicator.value !== undefined) {
                    grid.appendChild(createStressCard(indicator));
                }
            });
        }
        
        // Update liquidity indicators
        function updateLiquidityIndicators(gridId, liquidity) {
            const grid = document.getElementById(gridId);
            grid.innerHTML = '';
            
            const indicators = [
                {
                    title: 'SOFR (Overnight Rate)',
                    value: liquidity.OVERNIGHT_RATE,
                    score: liquidity.stress_score,
                    suffix: '%',
                    interpretation: 'Funding cost indicator'
                },
                {
                    title: 'Bank Reserves',
                    value: liquidity.RESERVES ? (liquidity.RESERVES / 1000).toFixed(1) : null,
                    score: liquidity.stress_score,
                    suffix: 'T',
                    interpretation: 'Banking system liquidity'
                },
                {
                    title: 'Reverse Repo Usage',
                    value: liquidity.REVERSE_REPO,
                    score: liquidity.stress_score,
                    suffix: 'B',
                    interpretation: liquidity.REVERSE_REPO > 2000 ? 'High usage' : 'Normal usage'
                }
            ];
            
            indicators.forEach(indicator => {
                if (indicator.value !== null && indicator.value !== undefined) {
                    grid.appendChild(createStressCard(indicator));
                }
            });
        }
        
        // Update systemic indicators
        function updateSystemicIndicators(gridId, systemic) {
            const grid = document.getElementById(gridId);
            grid.innerHTML = '';
            
            const indicators = [
                {
                    title: 'Financial Conditions',
                    value: systemic.FINANCIAL_CONDITIONS,
                    score: systemic.stress_score,
                    interpretation: systemic.FINANCIAL_CONDITIONS > 0 ? 'Tightening' : 'Loosening'
                },
                {
                    title: 'Stress Index',
                    value: systemic.STRESS_INDEX,
                    score: systemic.stress_score,
                    interpretation: systemic.STRESS_INDEX > 0 ? 'Above average stress' : 'Below average stress'
                }
            ];
            
            indicators.forEach(indicator => {
                if (indicator.value !== null && indicator.value !== undefined) {
                    grid.appendChild(createStressCard(indicator));
                }
            });
        }
        
        // Create stress card element
        function createStressCard(indicator) {
            const card = document.createElement('div');
            card.className = 'stress-card';
            
            // Add alert class if stress score is high
            if (indicator.score > 5) {
                card.classList.add('alert');
            }
            
            const scoreClass = indicator.score <= 3 ? 'score-low' : indicator.score <= 6 ? 'score-medium' : 'score-high';
            const valueColor = indicator.score <= 3 ? '#00ff88' : indicator.score <= 6 ? '#ffaa00' : '#ff4444';
            
            // Format value
            let displayValue = '';
            if (indicator.value !== null && indicator.value !== undefined) {
                if (typeof indicator.value === 'number') {
                    displayValue = indicator.value.toFixed(2) + (indicator.suffix || '');
                } else {
                    displayValue = indicator.value + (indicator.suffix || '');
                }
            } else {
                displayValue = 'N/A';
            }
            
            card.innerHTML = `
                <div class="stress-header">
                    <div class="stress-title">${indicator.title}</div>
                    <div class="stress-score ${scoreClass}">Score: ${indicator.score}/10</div>
                </div>
                <div class="stress-value" style="color: ${valueColor}">${displayValue}</div>
                <div class="stress-change neutral">
                    ${indicator.interpretation || 'Monitoring...'}
                </div>
            `;
            
            return card;
        }
        
        // Initialize all charts
        function initializeCharts() {
            const chartConfig = {
                paper_bgcolor: 'rgba(0, 0, 0, 0)',
                plot_bgcolor: 'rgba(0, 0, 0, 0.3)',
                font: { color: '#fff' },
                margin: { t: 30, r: 30, b: 30, l: 50 }
            };
            
            const config = {responsive: true};
            
            // Initialize all chart containers
            const chartIds = ['dashboardChart', 'treasuryChart', 'marketChart', 'liquidityChart', 'systemicChart', 'probabilityChart'];
            chartIds.forEach(id => {
                if (document.getElementById(id)) {
                    Plotly.newPlot(id, [], chartConfig, config);
                }
            });
        }
        
        // Update Dashboard Chart
        function updateDashboardChart() {
            if (!currentData.dashboard) return;
            
            const components = currentData.dashboard.crisis_assessment.components;
            const labels = Object.keys(components).map(k => k.charAt(0).toUpperCase() + k.slice(1));
            const values = Object.values(components);
            
            const trace = {
                x: labels,
                y: values,
                type: 'bar',
                marker: {
                    color: values.map(v => v <= 3 ? '#00ff88' : v <= 6 ? '#ffaa00' : '#ff4444')
                }
            };
            
            const layout = {
                title: 'Crisis Components',
                paper_bgcolor: 'rgba(0, 0, 0, 0)',
                plot_bgcolor: 'rgba(0, 0, 0, 0.3)',
                font: { color: '#fff' },
                xaxis: {
                    gridcolor: 'rgba(255, 255, 255, 0.1)',
                    tickfont: { color: '#888' }
                },
                yaxis: {
                    title: 'Stress Score',
                    gridcolor: 'rgba(255, 255, 255, 0.1)',
                    tickfont: { color: '#888' },
                    range: [0, 10]
                }
            };
            
            Plotly.newPlot('dashboardChart', [trace], layout, {responsive: true});
        }
        
        // Update Treasury Chart
        function updateTreasuryChart() {
            if (!currentData.treasury) return;
            
            const data = currentData.treasury.treasury_stress;
            const trace = {
                x: ['Bid-to-Cover', 'Foreign Part.', 'Indirect Bidders', 'Stress Score'],
                y: [data.bid_to_cover, data.foreign_participation/10, data.indirect_bidder_pct/10, data.stress_score],
                type: 'bar',
                marker: {
                    color: ['#00ccff', '#00ccff', '#00ccff', data.stress_score > 5 ? '#ff4444' : '#00ff88']
                }
            };
            
            const layout = {
                title: 'Treasury Market Metrics',
                paper_bgcolor: 'rgba(0, 0, 0, 0)',
                plot_bgcolor: 'rgba(0, 0, 0, 0.3)',
                font: { color: '#fff' }
            };
            
            Plotly.newPlot('treasuryChart', [trace], layout, {responsive: true});
        }
        
        // Update Market Chart
        function updateMarketChart() {
            if (!currentData.market) return;
            
            const data = currentData.market.market_stress;
            const trace = {
                x: ['VIX', 'TED Spread', 'Term Spread', 'DXY/10', 'Stress Score'],
                y: [data.VIX, data.TED_SPREAD*10, data.TERM_SPREAD_10Y2Y*10, data.DXY/10, data.stress_score],
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#ff4444', width: 2 },
                marker: { size: 8 }
            };
            
            const layout = {
                title: 'Market Stress Indicators',
                paper_bgcolor: 'rgba(0, 0, 0, 0)',
                plot_bgcolor: 'rgba(0, 0, 0, 0.3)',
                font: { color: '#fff' }
            };
            
            Plotly.newPlot('marketChart', [trace], layout, {responsive: true});
        }
        
        // Update Liquidity Chart
        function updateLiquidityChart() {
            if (!currentData.liquidity) return;
            
            const data = currentData.liquidity.liquidity_stress;
            const trace = {
                type: 'indicator',
                mode: 'gauge+number',
                value: data.stress_score,
                title: { text: 'Liquidity Stress Level' },
                gauge: {
                    axis: { range: [0, 10] },
                    bar: { color: data.stress_score > 5 ? '#ff4444' : data.stress_score > 3 ? '#ffaa00' : '#00ff88' },
                    steps: [
                        { range: [0, 3], color: 'rgba(0, 255, 136, 0.1)' },
                        { range: [3, 6], color: 'rgba(255, 170, 0, 0.1)' },
                        { range: [6, 10], color: 'rgba(255, 68, 68, 0.1)' }
                    ]
                }
            };
            
            const layout = {
                paper_bgcolor: 'rgba(0, 0, 0, 0)',
                font: { color: '#fff' }
            };
            
            Plotly.newPlot('liquidityChart', [trace], layout, {responsive: true});
        }
        
        // Update Systemic Chart
        function updateSystemicChart() {
            if (!currentData.systemic) return;
            
            const data = currentData.systemic.systemic_risk;
            const trace = {
                x: ['Financial Conditions', 'Stress Index', 'Overall Score'],
                y: [data.FINANCIAL_CONDITIONS || 0, data.STRESS_INDEX || 0, data.stress_score],
                type: 'bar',
                marker: {
                    color: ['#00ccff', '#ffaa00', data.stress_score > 5 ? '#ff4444' : '#00ff88']
                }
            };
            
            const layout = {
                title: 'Systemic Risk Indicators',
                paper_bgcolor: 'rgba(0, 0, 0, 0)',
                plot_bgcolor: 'rgba(0, 0, 0, 0.3)',
                font: { color: '#fff' }
            };
            
            Plotly.newPlot('systemicChart', [trace], layout, {responsive: true});
        }
        
        // Update Probability Chart
        function updateProbabilityChart() {
            if (currentData.historicalData.length < 2) return;
            
            const timestamps = currentData.historicalData.map(d => d.timestamp);
            const probabilities = currentData.historicalData.map(d => d.probability);
            
            const trace = {
                x: timestamps,
                y: probabilities,
                type: 'scatter',
                mode: 'lines+markers',
                name: 'Crisis Probability',
                line: {
                    color: '#ff4444',
                    width: 2
                },
                marker: {
                    size: 6,
                    color: probabilities.map(p => getColorForProbability(p))
                }
            };
            
            const layout = {
                title: 'Crisis Probability Trend',
                paper_bgcolor: 'rgba(0, 0, 0, 0)',
                plot_bgcolor: 'rgba(0, 0, 0, 0.3)',
                font: { color: '#fff' },
                xaxis: {
                    gridcolor: 'rgba(255, 255, 255, 0.1)',
                    tickfont: { color: '#888' }
                },
                yaxis: {
                    title: 'Probability (%)',
                    gridcolor: 'rgba(255, 255, 255, 0.1)',
                    tickfont: { color: '#888' },
                    range: [0, 100]
                }
            };
            
            Plotly.newPlot('probabilityChart', [trace], layout, {responsive: true});
        }
        
        // Get color for probability
        function getColorForProbability(probability) {
            if (probability < 15) return '#00ff88';
            if (probability < 30) return '#ffd700';
            if (probability < 50) return '#ffaa00';
            if (probability < 70) return '#ff6666';
            return '#ff0000';
        }
        
        // Get color for value
        function getColorForValue(key, value) {
            if (value === null) return '#888';
            
            // Stress scores
            if (key === 'stress_score') {
                if (value <= 3) return '#00ff88';
                if (value <= 6) return '#ffaa00';
                return '#ff4444';
            }
            
            // VIX
            if (key === 'VIX') {
                if (value < 15) return '#00ff88';
                if (value < 20) return '#ffaa00';
                return '#ff4444';
            }
            
            // Default
            return '#00ccff';
        }
        
        // Start auto-refresh
        function startAutoRefresh() {
            // Set up countdown
            countdownInterval = setInterval(() => {
                refreshCountdown--;
                document.getElementById('refreshTimer').textContent = refreshCountdown;
                
                if (refreshCountdown <= 0) {
                    refreshCountdown = 60;
                }
            }, 1000);
            
            // Set up data refresh
            refreshInterval = setInterval(() => {
                console.log('üîÑ Refreshing crisis data...');
                loadAllData();
            }, 60000); // 60 seconds
        }
        
        // Show error message
        function showError(message) {
            const container = document.querySelector('.container');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            container.insertBefore(errorDiv, container.firstChild);
            
            setTimeout(() => {
                errorDiv.remove();
            }, 5000);
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initializePlatform);
    </script>
</body>
</html>
